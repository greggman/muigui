!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).GUI=e()}(this,(function(){"use strict";function t(t,e={},n=[]){const i=document.createElement(t);return function(t,e,n){for(const[n,i]of Object.entries(e))if("function"==typeof i&&n.startsWith("on")){const e=n.substring(2).toLowerCase();t.addEventListener(e,i,{passive:!1})}else if("object"==typeof i)for(const[e,o]of Object.entries(i))t[n][e]=o;else void 0===t[n]?t.setAttribute(n,i):t[n]=i;for(const e of n)t.appendChild(e)}(i,e,n),i}function e(t,e){const n=t.indexOf(e);return n&&t.splice(n,1),t}function n(t,e,n){return Math.max(e,Math.min(n,t))}const i="undefined"!=typeof SharedArrayBuffer?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer},o=(t,e,n)=>Math.round(e(t)/n)/(1/n),s=(t,e)=>(t%e+e)%e;function r(t,e){for(const n in e)n in t&&(t[n]=e[n]);return t}class a{#t;#e=[];constructor(t){this.domElement=t,this.#t=t}addElem(t){return this.#t.appendChild(t),t}removeElem(t){return this.#t.removeChild(t),t}pushSubElem(t){this.#t.appendChild(t),this.#t=t}popSubElem(){this.#t=this.#t.parentElement}add(t){return this.#e.push(t),this.addElem(t.domElement),t}remove(t){return this.removeElem(t.domElement),e(this.#e,t),t}pushSubView(t){this.pushSubElem(t.domElement)}popSubView(){this.popSubElem()}setOptions(t){for(const e of this.#e)e.setOptions(t)}updateDisplayIfNeeded(t,e){for(const n of this.#e)n.updateDisplayIfNeeded(t,e);return this}$(t){return this.domElement.querySelector(t)}}class l extends a{#n;#i;#o;constructor(e){super(t("div",{className:"muigui-controller"})),this.#n=[],this.#i=[],e&&this.domElement.classList.add(e)}get parent(){return this.#o}setParent(t){this.#o=t,this.enable(!this.disabled())}show(t=!0){return this.domElement.classList.toggle("muigui-hide",!t),this.domElement.classList.toggle("muigui-show",t),this}hide(){return this.show(!1)}disabled(){return!!this.domElement.closest(".muigui-disabled")}enable(t=!0){return this.domElement.classList.toggle("muigui-disabled",!t),["input","button","select","textarea"].forEach((t=>{this.domElement.querySelectorAll(t).forEach((t=>{const e=!!t.closest(".muigui-disabled");t.disabled=e}))})),this}disable(t=!0){return this.enable(!t)}onChange(t){return this.removeChange(t),this.#n.push(t),this}removeChange(t){return e(this.#n,t),this}onFinishChange(t){return this.removeFinishChange(t),this.#i.push(t),this}removeFinishChange(t){return e(this.#i,t),this}#s(t,e){for(const n of t)n.call(this,e)}emitChange(t,e,n){this.#s(this.#n,t),this.#o&&(void 0===e?this.#o.emitChange(t):this.#o.emitChange({object:e,property:n,value:t,controller:this}))}emitFinalChange(t,e,n){this.#s(this.#i,t),this.#o&&(void 0===e?this.#o.emitChange(t):this.#o.emitFinalChange({object:e,property:n,value:t,controller:this}))}getColors(){const e=t=>t.replace(/-([a-z])/g,((t,e)=>e.toUpperCase())),n=t("div");this.domElement.appendChild(n);const i=Object.fromEntries(["color","bg-color","value-color","value-bg-color","hover-bg-color","menu-bg-color","menu-sep-color","disabled-color"].map((t=>{n.style.color=`var(--${t})`;const i=getComputedStyle(n);return[e(t),i.color]})));return n.remove(),i}}class u extends l{#r;#a;#l;#u={name:""};constructor(e,n,i={}){super("muigui-button",""),this.#r=e,this.#a=n,this.#l=this.addElem(t("button",{type:"button",onClick:()=>{this.#r[this.#a](this)}})),this.setOptions({name:n,...i})}setOptions(t){r(this.#u,t);const{name:e}=this.#u;this.#l.textContent=e}}function c(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class h extends a{#c;#h;#d(t){const e=!c(t,this.#c);return e&&function(t,e){e.length=t.length;for(let n=0;n<t.length;++n)e[n]=t[n]}(t,this.#c),e}#p(){let t=!0;return function(e){let n=t;return t=!1,n||(n=!c(e,this.#c)),n}}#m(t){let e=!1;for(const n in t)t[n]!==this.#c[n]&&(e=!0,this.#c[n]=t[n]);return e}#g(t){const e=t!==this.#c;return this.#c=t,e}#f(t){return Array.isArray(t)?(this.#c=[],this.#d.bind(this)):i(t)?(this.#c=new t.constructor(t),this.#p(this)):"object"==typeof t?(this.#c={},this.#m.bind(this)):this.#g.bind(this)}updateDisplayIfNeeded(t,e){this.#h=this.#h||this.#f(t),(this.#h(t)||e)&&this.updateDisplay(t)}setOptions(){return this}}class d extends h{constructor(e,n){const i=t("input",{type:"checkbox",id:n,onInput:()=>{e.setValue(this.domElement.checked)},onChange:()=>{e.setFinalValue(this.domElement.checked)}});super(t("label",{},[i]))}updateDisplay(t){this.domElement.checked=t}}const p=[],m=new Set;let g,f;function b(){g=void 0,f=!0;for(const t of p)m.has(t)||t();f=!1,m.size&&(f?v():(m.forEach((t=>{e(p,t)})),m.clear())),v()}function v(){!g&&p.length&&(g=requestAnimationFrame(b))}let x=0;function w(){return"muigui-"+ ++x}class y extends a{constructor(e=""){super(t("div",{className:"muigui-value"})),e&&this.domElement.classList.add(e)}}class k extends l{#b;#v;constructor(e="",n=""){super("muigui-label-controller"),this.#b=w(),this.#v=t("label",{for:this.#b}),this.domElement.appendChild(this.#v),this.pushSubView(new y(e)),this.name(n)}get id(){return this.#b}name(t){return this.#v.title===this.#v.textContent&&(this.#v.title=t),this.#v.textContent=t,this}tooltip(t){this.#v.title=t}}class E extends k{#r;#a;#x;#w;#e;#y;constructor(t,e,n=""){super(n,e),this.#r=t,this.#a=e,this.#x=this.getValue(),this.#w=!1,this.#e=[]}get initialValue(){return this.#x}get object(){return this.#r}get property(){return this.#a}add(t){return this.#e.push(t),super.add(t),this.updateDisplay(),t}#k(t,e){if("object"==typeof t){const e=this.#r[this.#a];if(Array.isArray(t))for(let n=0;n<t.length;++n)e[n]=t[n];else i(t)?e.set(t):Object.assign(e,t)}else this.#r[this.#a]=t;return this.updateDisplay(e),this.emitChange(this.getValue(),this.#r,this.#a),this}setValue(t){this.#k(t)}setFinalValue(t){return this.#k(t,!0),this.emitFinalChange(this.getValue(),this.#r,this.#a),this}updateDisplay(t){const e=this.getValue();for(const n of this.#e)n.updateDisplayIfNeeded(e,t);return this}setOptions(t){for(const e of this.#e)e.setOptions(t);return this.updateDisplay(),this}getValue(){return this.#r[this.#a]}value(t){return this.setValue(t),this}reset(){return this.setValue(this.#x),this}listen(t=!0){var e;return this.#y||(this.#y=this.updateDisplay.bind(this)),t?this.#w||(this.#w=!0,e=this.#y,p.push(e),v()):this.#w&&(this.#w=!1,function(t){m.set(t);const e=p.indexOf(t);e>=0&&p.splice(e,1)}(this.#y)),this}}class $ extends E{constructor(t,e){super(t,e,"muigui-checkbox");const n=this.id;this.add(new d(this,n)),this.updateDisplay()}}const C={to:t=>t,from:t=>[!0,t]},V={to:t=>t.toString(),from:t=>{const e=parseFloat(t);return[!Number.isNaN(e),e]}};function M(){let t=0;return function(e,n,i=5){t-=e.deltaY*n/i;const o=Math.floor(Math.abs(t)/n)*Math.sign(t)*n;return t-=o,o}}class I extends h{#E;#$;#C;#V;#u={step:.01,converters:V,min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY};constructor(e,i){const s=e.setValue.bind(e),r=e.setFinalValue.bind(e),a=M();super(t("input",{type:"number",onInput:()=>this.#M(s,!0),onChange:()=>this.#M(r,!1),onWheel:t=>{t.preventDefault();const{min:i,max:s,step:r}=this.#u,l=a(t,r),u=parseFloat(this.domElement.value),c=n(o(u+l,(t=>t),r),i,s);e.setValue(c)}})),this.setOptions(i)}#M(t,e){const i=parseFloat(this.domElement.value),[o,s]=this.#$(i);let r;if(o&&!Number.isNaN(i)){const{min:i,max:o}=this.#u;r=s>=i&&s<=o,this.#V=e,t(n(s,i,o))}this.domElement.classList.toggle("muigui-invalid-value",!o||!r)}updateDisplay(t){this.#V||(this.domElement.value=o(t,this.#E,this.#C)),this.#V=!1}setOptions(t){r(this.#u,t);const{step:e,converters:{to:n,from:i}}=this.#u;return this.#E=n,this.#$=i,this.#C=e,this}}class D extends E{#I;#C;constructor(t,e,n={}){super(t,e,"muigui-checkbox"),this.#I=this.add(new I(this,n)),this.updateDisplay()}}class F extends h{#D;constructor(e,n){const i=[];super(t("select",{onChange:()=>{e.setFinalValue(this.#D[this.domElement.selectedIndex])}},n.map((([e,n])=>(i.push(n),t("option",{textContent:e})))))),this.#D=i}updateDisplay(t){const e=this.#D.indexOf(t);this.domElement.selectedIndex=e}}function L(t,e){return Array.isArray(t)?Array.isArray(t[0])?t:e?t.map(((t,e)=>[t,e])):t.map((t=>[t,t])):[...Object.entries(t)]}class N extends E{constructor(t,e,n){super(t,e,"muigui-select");const i="number"==typeof this.getValue(),{keyValues:o}=n,s=L(o,i);this.add(new F(this,s)),this.updateDisplay()}}class S extends h{#E;#$;#C;#V;#u={step:.01,min:0,max:1,converters:C};constructor(e,i){const s=M();super(t("input",{type:"range",onInput:()=>{this.#V=!0;const[t,n]=this.#$(parseFloat(this.domElement.value));t&&e.setValue(n)},onChange:()=>{this.#V=!0;const[t,n]=this.#$(parseFloat(this.domElement.value));t&&e.setFinalValue(n)},onWheel:t=>{t.preventDefault();const[i,r]=this.#$(parseFloat(this.domElement.value));if(!i)return;const{min:a,max:l,step:u}=this.#u,c=s(t,u),h=n(o(r+c,(t=>t),u),a,l);e.setValue(h)}})),this.setOptions(i)}updateDisplay(t){this.#V||(this.domElement.value=o(t,this.#E,this.#C)),this.#V=!1}setOptions(t){r(this.#u,t);const{step:e,min:n,max:i,converters:{to:o,from:s}}=this.#u;return this.#E=o,this.#$=s,this.#C=e,this.domElement.step=e,this.domElement.min=n,this.domElement.max=i,this}}class A extends E{constructor(t,e,n){super(t,e,"muigui-range"),this.add(new S(this,n)),this.add(new I(this,n))}}class U extends h{#E;#$;#V;#u={converters:C};constructor(e,n){const i=e.setValue.bind(e),o=e.setFinalValue.bind(e);super(t("input",{type:"text",onInput:()=>this.#M(i,!0),onChange:()=>this.#M(o,!1)})),this.setOptions(n)}#M(t,e){const[n,i]=this.#$(this.domElement.value);n&&(this.#V=e,t(i)),this.domElement.style.color=n?"":"var(--invalid-color)"}updateDisplay(t){this.#V||(this.domElement.value=this.#E(t),this.domElement.style.color=""),this.#V=!1}setOptions(t){r(this.#u,t);const{converters:{to:e,from:n}}=this.#u;return this.#E=e,this.#$=n,this}}class O extends E{constructor(t,e){super(t,e,"muigui-checkbox"),this.add(new U(this)),this.updateDisplay()}}class j extends a{constructor(e,n){super(t(e,{className:n}))}}class T extends k{#F;constructor(){super("muigui-canvas"),this.#F=this.add(new j("canvas","muigui-canvas")).domElement}get canvas(){return this.#F}}const z=(t,e,n)=>Math.max(e,Math.min(n,t)),P=t=>+t.toFixed(3),G=t=>parseInt(t.substring(1,3),16)<<16|parseInt(t.substring(3,5),16)<<8|parseInt(t.substring(5,7),16),B=t=>[parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16)],H=t=>`#${Array.from(t).map((t=>t.toString(16).padStart(2,"0"))).join("")}`,R=t=>B(t).map((t=>P(t/255))),Y=t=>H(Array.from(t).map((t=>Math.round(z(255*t,0,255))))),W=t=>({r:parseInt(t.substring(1,3),16)/255,g:parseInt(t.substring(3,5),16)/255,b:parseInt(t.substring(5,7),16)/255}),q=t=>z(Math.round(255*t),0,255).toString(16).padStart(2,"0"),_=t=>`rgb(${B(t).join(", ")})`,J=/^\s*rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/,K=t=>{const e=Q(B(t)).map((t=>(t=>+t.toFixed(0))(t)));return`hsl(${e[0]}, ${e[1]}%, ${e[2]}%)`},X=/^\s*hsl\(\s*(\d+)(?:deg|)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/,Z=(t,e)=>(t%e+e)%e;const Q=t=>{const[e,n,i]=function([t,e,n]){const i=Math.max(t,e,n),o=Math.min(t,e,n),s=.5*(o+i),r=i-o;let a=0,l=0;if(0!==r)switch(l=0===s||1===s?0:(i-s)/Math.min(s,1-s),i){case t:a=(e-n)/r+(e<n?6:0);break;case e:a=(n-t)/r+2;break;case n:a=(t-e)/r+4}return[a/6,l,s]}(t.map((t=>t/255)));return[360*e,100*n,100*i]};function tt([t,e,n]){return e=z(e,0,1),n=z(n,0,1),[t,t+2/3,t+1/3].map((t=>{return i=1,o=z(Math.abs(6*(t=>t>=0?t%1:1-t%1)(t)-3)-1,0,1),(i+(o-i)*e)*n;var i,o}))}const et=t=>Math.round(1e3*t)/1e3;function nt([t,e,n]){const i=n>e?[n,e,-1,2/3]:[e,n,0,-1/3],o=i[0]>t?[i[0],i[1],i[3],t]:[t,i[1],i[2],i[0]],s=o[0]-Math.min(o[3],o[1]);return[Math.abs(o[2]+(o[3]-o[1])/(6*s+Number.EPSILON)),s/(o[0]+Number.EPSILON),o[0]].map(et)}window.hsv01ToRGBFloat=tt,window.rgbFloatToHSV01=nt;const it=[{re:/^#(?:[0-9a-f]){6}$/i,format:"hex6"},{re:/^(?:[0-9a-f]){6}$/i,format:"hex6-no-hash"},{re:/^#(?:[0-9a-f]){3}$/i,format:"hex3"},{re:/^(?:[0-9a-f]){3}$/i,format:"hex3-no-hash"},{re:J,format:"css-rgb"},{re:X,format:"css-hsl"}];function ot(t){switch(typeof t){case"number":return"uint32-rgb";case"string":{const e=function(t){for(const e of it)if(e.re.test(t))return e}(t.trim());if(e)return e.format;break}case"object":if(t instanceof Uint8Array||t instanceof Uint8ClampedArray){if(3===t.length)return"uint8-rgb"}else if(t instanceof Float32Array){if(3===t.length)return"float-rgb"}else if(Array.isArray(t)){if(3===t.length)return"float-rgb"}else if("r"in t&&"g"in t&&"b"in t)return"object-rgb"}throw new Error(`unknown color format: ${t}`)}function st(t){return t.trim(t)}function rt(t){return t[1]===t[2]&&t[3]===t[4]&&t[5]===t[6]?`#${t[1]}${t[3]}${t[5]}`:t}const at=/^(#|)([0-9a-f]{3})$/i;function lt(t){const e=at.exec(t);if(e){const[,,t]=e;return"#"+`${(n=t)[0]}${n[0]}${n[1]}${n[1]}${n[2]}${n[2]}`}var n;return t}function ut(t){return rt(st(t))}const ct=t=>{const e=J.exec(t);if(!e)return[!1];const n=[e[1],e[2],e[3]].map((t=>parseInt(t)));return[!n.find((t=>t>255)),`rgb(${n.join(", ")})`]},ht=t=>{const e=X.exec(t);if(!e)return[!1];const n=[e[1],e[2],e[3]].map((t=>parseFloat(t)));return[!n.find((t=>Number.isNaN(t))),`hsl(${n[0]}, ${n[1]}%, ${n[2]}%)`]},dt=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*$/,pt=/^\s*(?:0x){0,1}([0-9a-z]{1,6})\s*$/i,mt=/^\s*#[a-f0-9]{6}\s*$|^\s*#[a-f0-9]{3}\s*$/i,gt=/^\s*[a-f0-9]{6}\s*$/i,ft={hex6:{color:{from:t=>[!0,t],to:st},text:{from:t=>[mt.test(t),t.trim()],to:t=>t}},hex3:{color:{from:t=>[!0,ut(t)],to:lt},text:{from:t=>[mt.test(t),rt(t.trim())],to:t=>t}},"hex6-no-hash":{color:{from:t=>[!0,t.substring(1)],to:t=>`#${st(t)}`},text:{from:t=>[gt.test(t),t.trim()],to:t=>t}},"hex3-no-hash":{color:{from:t=>[!0,ut(t).substring(1)],to:lt},text:{from:t=>[gt.test(t),rt(t.trim())],to:t=>t}},"uint32-rgb":{color:{from:t=>[!0,G(t)],to:t=>`#${Math.round(t).toString(16).padStart(6,"0")}`},text:{from:t=>(t=>{const e=pt.exec(t);return e?[!0,parseInt(e[1],16)]:[!1]})(t),to:t=>`0x${t.toString(16).padStart(6,"0")}`}},"uint8-rgb":{color:{from:t=>[!0,B(t)],to:H},text:{from:t=>{const e=dt.exec(t);if(!e)return[!1];const n=[e[1],e[2],e[3]].map((t=>parseInt(t)));return[!n.find((t=>t>255)),n]},to:t=>t.join(", ")}},"float-rgb":{color:{from:t=>[!0,R(t)],to:Y},text:{from:t=>{const e=t.split(",").map((t=>t.trim())),n=e.map((t=>parseFloat(t)));if(3!==n.length)return[!1];const i=e.findIndex((t=>isNaN(t)));return[i<0,n.map((t=>P(t)))]},to:t=>Array.from(t).map((t=>P(t))).join(", ")}},"object-rgb":{color:{from:t=>[!0,W(t)],to:t=>`#${q(t.r)}${q(t.g)}${q(t.b)}`},text:{from:t=>{try{const e=t.replace(/([a-z])/g,'"$1"'),n=JSON.parse(e);if(Number.isNaN(n.r)||Number.isNaN(n.g)||Number.isNaN(n.b))throw new Error("not {r, g, b}");return[!0,n]}catch(t){return[!1]}},to:t=>`{r:${P(t.r)}, g:${P(t.g)}, b:${P(t.b)}}`}},"css-rgb":{color:{from:t=>[!0,_(t)],to:t=>{const e=J.exec(t);return H([e[1],e[2],e[3]].map((t=>parseInt(t))))}},text:{from:ct,to:t=>ct(t)[1]}},"css-hsl":{color:{from:t=>[!0,K(t)],to:t=>{const e=X.exec(t),n=function([t,e,n]){t=Z(t,360),e=z(e/100,0,1),n=z(n/100,0,1);const i=e*Math.min(n,1-n);function o(e){const o=(e+t/30)%12;return n-i*Math.max(-1,Math.min(o-3,9-o,1))}return[o(0),o(8),o(4)].map((t=>Math.round(255*t)))}([e[1],e[2],e[3]].map((t=>parseFloat(t))));return H(n)}},text:{from:ht,to:t=>ht(t)[1]}}};class bt extends h{#E;#$;#L;#V;#u={converters:C};constructor(e,n){const i=t("input",{type:"color",onInput:()=>{const[t,n]=this.#$(i.value);t&&(this.#V=!0,e.setValue(n))},onChange:()=>{const[t,n]=this.#$(i.value);t&&(this.#V=!0,e.setFinalValue(n))}});super(t("div",{},[i])),this.setOptions(n),this.#L=i}updateDisplay(t){this.#V||(this.#L.value=this.#E(t)),this.#V=!1}setOptions(t){r(this.#u,t);const{converters:{to:e,from:n}}=this.#u;return this.#E=e,this.#$=n,this}}class vt extends E{#N;#I;constructor(t,e,n={}){super(t,e,"muigui-color");const i=n.format||ot(this.getValue()),{color:o,text:s}=ft[i];this.#N=this.add(new bt(this,{converters:o})),this.#I=this.add(new U(this,{converters:s})),this.updateDisplay()}setOptions(t){const{format:e}=t;if(e){const{color:t,text:n}=ft[e];this.#N.setOptions({converters:t}),this.#I.setOptions({converters:n})}return super.setOptions(t),this}}class xt extends l{constructor(){super("muigui-divider")}}class wt extends l{#S;#A;constructor(t){super(t),this.#S=[],this.#A=this}get children(){return this.#S}get controllers(){return this.#S.filter((t=>!(t instanceof wt)))}get folders(){return this.#S.filter((t=>t instanceof wt))}reset(t=!0){for(const e of this.#S)e instanceof wt&&!t||e.reset(t);return this}remove(t){const e=this.#S.indexOf(t);if(e>=0){const t=this.#S.splice(e,1)[0];t.domElement.remove(),t.setParent(null)}return this}_addControllerImpl(t){return this.domElement.appendChild(t.domElement),this.#S.push(t),t.setParent(this),t}addController(t){return this.#A._addControllerImpl(t)}pushContainer(t){return this.addController(t),this.#A=t,t}popContainer(){return this.#A=this.#A.parent,this}}class yt extends wt{#U;constructor(e="Controls",n="muigui-menu"){super(n),this.#U=t("label"),this.addElem(t("button",{type:"button",onClick:()=>this.toggleOpen()},[this.#U])),this.pushContainer(new wt),this.name(e),this.open()}open(t=!0){return this.domElement.classList.toggle("muigui-closed",!t),this.domElement.classList.toggle("muigui-open",t),this}close(){return this.open(!1)}name(t){return this.#U.textContent=t,this}title(t){return this.name(t)}toggleOpen(){return this.open(!this.domElement.classList.contains("muigui-open")),this}}class kt extends l{constructor(t){super("muigui-label"),this.text(t)}text(t){return this.domElement.textContent=t,this}}let Et=!1;const $t=t("style");class Ct extends yt{add(t,e,...n){const i=t instanceof l?t:function(t,e,...n){const[i]=n;if(Array.isArray(i))return new N(t,e,{keyValues:i});const o=typeof t[e];switch(o){case"number":if("number"==typeof n[0]&&"number"==typeof n[1]){const i=n[0],o=n[1],s=n[2];return new A(t,e,{min:i,max:o,...s&&{step:s}})}return 0===n.length?new D(t,e,...n):new A(t,e,...n);case"boolean":return new $(t,e,...n);case"function":return new u(t,e,...n);case"string":return new O(t,e,...n);default:throw new Error(`unhandled type ${o} for property ${e}`)}}(t,e,...n);return this.addController(i)}addCanvas(t){return this.addController(new T(t))}addColor(t,e,...n){return this.addController(new vt(t,e,...n))}addDivider(){return this.addController(new xt)}addFolder(t){return this.addController(new Ct(t))}addLabel(t){return this.addController(new kt(t))}}class Vt extends Ct{constructor(t={}){super("Controls","muigui-root"),t instanceof HTMLElement&&(t={parent:t});const{autoPlace:e=!0,width:n,title:i="Controls",injectStyles:o=!0}=t;let{parent:s}=t;o&&!Et&&(Et=!0,(document.head||document.documentElement).appendChild($t),$t.textContent='\n.muigui {\n  --width: 250px;\n  --label-width: 45%;\n  --number-width: 40%;\n\n  --bg-color: #222222;\n  --color: #dddddd;\n  --value-color: #43e5f7;\n  --value-bg-color: #444444;\n  --disabled-color: #666666;\n  --menu-bg-color: #000000;\n  --menu-sep-color: #444444;\n  --hover-bg-color: #666666;\n  --focus-color: #88AAFF;\n  --range-color: #888888;\n  --invalid-color: #FF6666;\n  --selected-color: rgba(255, 255, 255, 0.3);\n\n  --button-bg-color: var(--value-bg-color);\n\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-size: 11px;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --font-size-mono: 11px;\n\n  --range-left-color: var(--value-color);\n  --range-right-color: var(--value-bg-color);\n  --range-right-hover-color: var(--hover-bg-color);\n  --line-height: 1.7em;\n  --border-radius: 0px;\n\n  width: var(--width);\n  color: var(--color);\n  background-color: var(--bg-color);\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  box-sizing: border-box;\n}\n.muigui * {\n  box-sizing: inherit;\n}\n\n.muigui-no-scroll {\n  touch-action: none;\n}\n.muigui-no-h-scroll {\n  touch-action: pan-y;\n}\n.muigui-no-v-scroll {\n  touch-action: pan-x;\n}\n\n.muigui-invalid-value {\n  background-color: red !important;\n  color: white !important;\n}\n\n.muigui-grid {\n  display: grid;\n}\n.muigui-rows {\n  display: flex;\n  flex-direction: column;\n\n  min-height: 20px;\n  border: 2px solid red;\n}\n.muigui-columns {\n  display: flex;\n  flex-direction: row;\n\n  height: 20px;\n  border: 2px solid green;\n}\n.muigui-rows>*,\n.muigui-columns>* {\n  flex: 1 1 auto;\n  align-items: stretch;\n  min-height: 0;\n  min-width: 0;\n}\n\n.muigui-row {\n  border: 2px solid yellow;\n  min-height: 10px\n}\n.muigui-column {\n  border: 2px solid lightgreen;\n}\n\n/* -------- */\n\n.muigui-show { /* */ }\n.muigui-hide { \n  display: none !important;\n}\n.muigui-disabled {\n  pointer-events: none;\n  --color: var(--disabled-color) !important;\n  --value-color: var(--disabled-color) !important;\n  --range-left-color: var(--disabled-color) !important;\n}\n\n.muigui canvas,\n.muigui svg {\n  display: block;\n  border-radius: var(--border-radius);\n}\n.muigui canvas {\n  background-color: var(--value-bg-color);\n}\n\n.muigui-controller {\n  min-width: 0;\n  min-height: var(--line-height);\n}\n.muigui-root,\n.muigui-menu {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  user-select: none;\n  height: fit-content;\n  margin: 0;\n  padding-bottom: 0.1em;\n  border-radius: var(--border-radius);\n}\n.muigui-menu {\n  border-bottom: 1px solid var(--menu-sep-color);\n}\n\n.muigui-root>button:nth-child(1),\n.muigui-menu>button:nth-child(1) {\n  border-top: 1px solid var(--menu-sep-color);\n  border-bottom: 1px solid var(--menu-sep-color);\n  position: relative;\n  text-align: left;\n  color: var(--color);\n  background-color: var(--menu-bg-color);\n  min-height: var(--line-height);\n  padding-top: 0.2em;\n  padding-bottom: 0.2em;\n  cursor: pointer;\n  border-radius: var(--border-radius);\n}\n.muigui-root>div:nth-child(2),\n.muigui-menu>div:nth-child(2) {\n  flex: 1 1 auto;\n}\n\n.muigui-controller {\n  margin-left: 0.2em;\n  margin-right: 0.2em;\n}\n.muigui-root.muigui-controller,\n.muigui-menu.muigui-controller {\n  margin-left: 0;\n  margin-right: 0;\n}\n.muigui-controller>*:nth-child(1) {\n  flex: 1 0 var(--label-width);\n  min-width: 0;\n  white-space: pre;\n}\n.muigui-controller>label:nth-child(1) {\n  place-content: center start;\n  display: inline-grid;\n  overflow: hidden;\n}\n.muigui-controller>*:nth-child(2) {\n  flex: 1 1 75%;\n  min-width: 0;\n}\n\n/* -----------------------------------------\n  a label controller is  [[label][value]]\n*/\n\n.muigui-label-controller {\n  display: flex;\n  margin: 0.4em 0 0.4em 0;\n  word-wrap: initial;\n  align-items: stretch;\n}\n\n.muigui-value {\n  display: flex;\n  align-items: stretch;\n}\n.muigui-value>* {\n  flex: 1 1 auto;\n  min-width: 0;\n}\n.muigui-value>*:nth-child(1) {\n  flex: 1 1 calc(100% - var(--number-width));\n}\n.muigui-value>*:nth-child(2) {\n  flex: 1 1 var(--number-width);\n  margin-left: 0.2em;\n}\n\n/* fix! */\n.muigui-open>button>label::before,\n.muigui-closed>button>label::before {\n  width: 1.25em;\n  height: var(--line-height);\n  display: inline-grid;\n  place-content: center start;\n  pointer-events: none;\n}\n.muigui-open>button>label::before {\n  content: "ⓧ"; /*"▼";*/\n}\n.muigui-closed>button>label::before {\n  content: "⨁"; /*"▶";*/\n}\n.muigui-open>*:nth-child(2) {\n  transition: max-height 0.2s ease-out,\n              opacity 0.5s ease-out;\n  max-height: 100vh;\n  overflow: auto;\n  opacity: 1;\n}\n\n.muigui-closed>*:nth-child(2) {\n  transition: max-height 0.2s ease-out,\n              opacity 1s;\n  max-height: 0;\n  opacity: 0;\n  overflow: hidden;\n}\n\n/* ---- popdown ---- */\n\n.muigui-pop-down-top {\n  display: flex;\n}\n/* fix? */\n.muigui-value>*:nth-child(1).muigui-pop-down-top {\n  flex: 0;\n}\n.muigui-pop-down-bottom {\n\n}\n\n.muigui-pop-down-values {\n  min-width: 0;\n  display: flex;\n}\n.muigui-pop-down-values>* {\n  flex: 1 1 auto;\n  min-width: 0;\n}\n\n.muigui-value.muigui-pop-down-controller {\n  flex-direction: column;\n}\n\n.muigui-pop-down-top input[type=checkbox] {\n  -webkit-appearance: none;\n  appearance: none;\n  width: auto;\n  color: var(--value-color);\n  background-color: var(--value-bg-color);\n  cursor: pointer;\n\n  display: grid;\n  place-content: center;\n  margin: 0;\n  font: inherit;\n  color: currentColor;\n  width: 1.7em;\n  height: 1.7em;\n  transform: translateY(-0.075em);\n}\n\n.muigui-pop-down-top input[type=checkbox]::before {\n  content: "+";\n  display: grid;\n  place-content: center;\n  border-radius: calc(var(--border-radius) + 2px);\n  border-left: 1px solid rgba(255,255,255,0.3);\n  border-top: 1px solid rgba(255,255,255,0.3);\n  border-bottom: 1px solid rgba(0,0,0,0.2);\n  border-right: 1px solid rgba(0,0,0,0.2);\n  background-color: var(--range-color);\n  color: var(--value-bg-color);\n  width: calc(var(--line-height) - 4px);\n  height: calc(var(--line-height) - 4px);\n}\n\n.muigui-pop-down-top input[type=checkbox]:checked::before {\n  content: "Ｘ";\n}\n\n\n/* ---- select ---- */\n\n.muigui select,\n.muigui option,\n.muigui input,\n.muigui button {\n  color: var(--value-color);\n  background-color: var(--value-bg-color);\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  border: none;\n  margin: 0;\n  border-radius: var(--border-radius);\n}\n.muigui select {\n  appearance: none;\n  margin: 0;\n  margin-left: 0; /*?*/\n  overflow: hidden; /* Safari */\n}\n\n.muigui select:focus,\n.muigui input:focus,\n.muigui button:focus {\n  outline: 1px solid var(--focus-color);\n}\n\n.muigui select:hover,\n.muigui option:hover,\n.muigui input:hover,\n.muigui button:hover {\n  background-color: var(--hover-bg-color);  \n}\n\n/* ------ [ label ] ------ */\n\n.muigui-label {\n  border-top: 1px solid var(--menu-sep-color);\n  border-bottom: 1px solid var(--menu-sep-color);\n  padding-top: 0.4em;\n  padding-bottom: 0.3em;\n  place-content: center start;\n  background-color: var(--menu-bg-color);\n  white-space: pre;\n  border-radius: var(--border-radius);\n}\n\n/* ------ [ divider] ------ */\n\n.muigui-divider {\n    min-height: 6px;\n    border-top: 2px solid var(--menu-sep-color);\n    margin-top: 6px;\n}\n\n/* ------ [ button ] ------ */\n\n.muigui-button {\n  display: grid;\n\n}\n.muigui-button button {\n  border: none;\n  color: var(--value-color);\n  background-color: var(--button-bg-color);\n  cursor: pointer;\n  place-content: center center;\n}\n\n/* ------ [ color ] ------ */\n\n.muigui-color>div {\n  overflow: hidden;\n  position: relative;\n  margin-left: 0;\n  margin-right: 0; /* why? */\n  max-width: var(--line-height);\n  border-radius: var(--border-radius);\n}\n\n.muigui-color>div:focus-within {\n  outline: 1px solid var(--focus-color);\n}\n\n.muigui-color input[type=color] {\n  border: none;\n  padding: 0;\n  background: inherit;\n  cursor: pointer;\n  position: absolute;\n  width: 200%;\n  left: -10px;\n  top: -10px;\n  height: 200%;\n}\n.muigui-disabled canvas,\n.muigui-disabled svg,\n.muigui-disabled img,\n.muigui-disabled .muigui-color input[type=color] {\n  opacity: 0.2;\n}\n\n/* ------ [ checkbox ] ------ */\n\n.muigui-checkbox>label:nth-child(2) {\n  display: grid;\n  place-content: center start;\n  margin: 0;\n}\n\n.muigui-checkbox input[type=checkbox] {\n  -webkit-appearance: none;\n  appearance: none;\n  width: auto;\n  color: var(--value-color);\n  background-color: var(--value-bg-color);\n  cursor: pointer;\n\n  display: grid;\n  place-content: center;\n  margin: 0;\n  font: inherit;\n  color: currentColor;\n  width: 1.7em;\n  height: 1.7em;\n  transform: translateY(-0.075em);\n}\n\n.muigui-checkbox input[type=checkbox]::before {\n  content: "";\n  color: var(--value-color);\n  display: grid;\n  place-content: center;\n}\n\n.muigui-checkbox input[type=checkbox]:checked::before {\n  content: "✔";\n}\n\n.muigui input[type=number]::-webkit-inner-spin-button, \n.muigui input[type=number]::-webkit-outer-spin-button { \n  -webkit-appearance: none;\n  appearance: none;\n  margin: 0; \n}\n.muigui input[type=number] {\n  -moz-appearance: textfield;\n}\n\n/* ------ [ radio grid ] ------ */\n\n.muigui-radio-grid>div {\n  display: grid;\n  gap: 2px;\n}\n\n.muigui-radio-grid input {\n  appearance: none;\n  display: none;\n}\n\n.muigui-radio-grid button {\n  color: var(--color);\n  width: 100%;\n  text-align: left;\n}\n\n.muigui-radio-grid input:checked + button {\n  color: var(--value-color);\n  background-color: var(--selected-color);\n}\n\n/* ------ [ color-chooser ] ------ */\n\n.muigui-color-chooser-cursor {\n  stroke-width: 1px;\n  stroke: white;\n  fill: none;\n}\n.muigui-color-chooser-circle {\n  stroke-width: 1px;\n  stroke: white;\n  fill: none;\n}\n\n\n/* ------ [ vec2 ] ------ */\n\n.muigui-vec2 svg {\n  background-color: var(--value-bg-color);\n}\n\n.muigui-vec2-axis {\n  stroke: 1px;\n  stroke: var(--focus-color);\n}\n\n.muigui-vec2-line {\n  stroke-width: 1px;\n  stroke: var(--value-color);\n  fill: var(--value-color);\n}\n\n/* ------ [ direction ] ------ */\n\n.muigui-direction svg {\n  background-color: rgba(0,0,0,0.2);\n}\n\n.muigui-direction:focus-within svg {\n  outline: none;\n}\n.muigui-direction-range {\n  fill: var(--value-bg-color);\n}\n.muigui-direction svg:focus {\n  outline: none;\n}\n.muigui-direction svg:focus .muigui-direction-range {\n  stroke-width: 0.5px;\n  stroke: var(--focus-color);\n}\n\n.muigui-direction-arrow {\n  fill: var(--value-color);\n}\n\n/* ------ [ slider ] ------ */\n\n.muigui-slider>div {\n  display: flex;\n  align-items: stretch;\n  height: var(--line-height);\n}\n.muigui-slider svg {\n  flex: 1 1 auto;\n}\n.muigui-slider .muigui-slider-up #muigui-orientation {\n  transform: scale(1, -1) translateY(-100%);\n}\n\n.muigui-slider .muigui-slider-up #muigui-number-orientation {\n  transform: scale(1,-1);\n}\n\n.muigui-ticks {\n  stroke: var(--range-color);\n}\n.muigui-thicks {\n  stroke: var(--color);\n  stroke-width: 2px;\n}\n.muigui-svg-text {\n  fill: var(--color);\n  font-size: 7px;\n}\n.muigui-mark {\n  fill: var(--value-color);\n}\n\n/* ------ [ range ] ------ */\n\n\n.muigui-range input[type=range] {\n  -webkit-appearance: none;\n  appearance: none;\n  background-color: transparent;\n}\n\n.muigui-range input[type=range]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  border-radius: calc(var(--border-radius) + 2px);\n  border-left: 1px solid rgba(255,255,255,0.3);\n  border-top: 1px solid rgba(255,255,255,0.3);\n  border-bottom: 1px solid rgba(0,0,0,0.2);\n  border-right: 1px solid rgba(0,0,0,0.2);\n  background-color: var(--range-color);\n  margin-top: calc((var(--line-height) - 2px) / -2);\n  width: calc(var(--line-height) - 2px);\n  height: calc(var(--line-height) - 2px);\n}\n\n.muigui-range input[type=range]::-webkit-slider-runnable-track {\n  -webkit-appearance: none;\n  appearance: none;\n  border: 1px solid var(--menu-sep-color);\n  height: 2px;\n}\n\n\n/* dat.gui style - doesn\'t work on Safari iOS */\n\n/*\n.muigui-range input[type=range] {\n  cursor: ew-resize;\n  overflow: hidden;\n}\n\n.muigui-range input[type=range] {\n  -webkit-appearance: none;\n  appearance: none;\n  background-color: var(--range-right-color);\n  margin: 0;\n}\n.muigui-range input[type=range]:hover {\n  background-color: var(--range-right-hover-color);\n}\n\n.muigui-range input[type=range]::-webkit-slider-runnable-track {\n  -webkit-appearance: none;\n  appearance: none;\n  height: max-content;\n  color: var(--range-left-color);\n  margin-top: -1px;\n}\n\n.muigui-range input[type=range]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  width: 0px;\n  height: max-content;\n  box-shadow: -1000px 0 0 1000px var(--range-left-color);\n}\n*/\n\n/* FF */\n/*\n.muigui-range input[type=range]::-moz-slider-progress {\n  background-color: var(--range-left-color); \n}\n.muigui-range input[type=range]::-moz-slider-thumb {\n  height: max-content;\n  width: 0;\n  border: none;\n  box-shadow: -1000px 0 0 1000px var(--range-left-color);\n  box-sizing: border-box;\n}\n*/\n\n/* ---------------------------------------------------------- */\n\n/* needs to be at bottom to take precedence */\n.muigui-auto-place {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 100001;\n}\n\n'),n&&(this.domElement.style.width=/^\d+$/.test(n)?`${n}px`:n),void 0===s&&e&&(s=document.body,this.domElement.classList.add("muigui-auto-place")),s&&s.appendChild(this.domElement),i&&this.title(i),this.domElement.classList.add("muigui")}}function Mt(){}function It(t,e,n){const i=t.getBoundingClientRect(),o=e.clientX-i.left,s=e.clientY-i.top,r=o/i.width,a=s/i.height,l=o-(n=n||[o,s])[0],u=s-n[1];return{x:o,y:s,nx:r,ny:a,dx:l,dy:u,ndx:l/i.width,ndy:u/i.width}}function Dt(t,{onDown:e=Mt,onMove:n=Mt,onUp:i=Mt}){let o;const s=function(e){const i={type:"move",...It(t,e,o)};n(i)},r=function(e){t.releasePointerCapture(e.pointerId),t.removeEventListener("pointermove",s),t.removeEventListener("pointerup",r),document.body.style.backgroundColor="",i("up")},a=function(n){t.addEventListener("pointermove",s),t.addEventListener("pointerup",r),t.setPointerCapture(n.pointerId);const i=It(t,n);o=[i.x,i.y],e({type:"down",...i})};return t.addEventListener("pointerdown",a),function(){t.removeEventListener("pointerdown",a)}}class Ft extends h{#O;#j;#T;#z;#P;#G;#B;#H;constructor(e){super(t("div",{innerHTML:'\n\n<svg tabindex="0" viewBox="0 0 64 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">\n    <linearGradient id="muigui-color-chooser-light-dark" x1="0" x2="0" y1="0" y2="1">\n      <stop stop-color="rgba(0,0,0,0)" offset="0%"/>\n      <stop stop-color="#000" offset="100%"/>\n    </linearGradient>\n    <linearGradient id="muigui-color-chooser-hue">\n      <stop stop-color="hsl(60, 0%, 100%)" offset="0%"/>\n      <stop stop-color="hsl(60, 100%, 50%)" offset="100%"/>\n    </linearGradient>\n\n    <rect width="64" height="48" fill="url(#muigui-color-chooser-hue)"/>\n    <rect width="64" height="48" fill="url(#muigui-color-chooser-light-dark)"/>\n    <circle r="4" class="muigui-color-chooser-circle"/>\n</svg>\n<svg tabindex="0" viewBox="0 0 64 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">\n    <linearGradient id="muigui-color-chooser-hues" x1="0" x2="1" y1="0" y2="0">\n      <stop stop-color="hsl(0,100%,50%)" offset="0%"/>\n      <stop stop-color="hsl(60,100%,50%)" offset="16.666%"/>\n      <stop stop-color="hsl(120,100%,50%)" offset="33.333%"/>\n      <stop stop-color="hsl(180,100%,50%)" offset="50%"/>\n      <stop stop-color="hsl(240,100%,50%)" offset="66.666%"/>\n      <stop stop-color="hsl(300,100%,50%)" offset="83.333%"/>\n      <stop stop-color="hsl(360,100%,50%)" offset="100%"/>\n    </linearGradient>\n    <rect y="1" width="64" height="4" fill="url(\'#muigui-color-chooser-hues\')"/>\n    <g class="muigui-color-chooser-cursor">\n      <rect x="-3" width="6" height="6" />\n    </g>\n</svg>\n',className:"muigui-no-scroll"})),this.#O=this.domElement.children[0],this.#j=this.domElement.children[1],this.#T=this.$(".muigui-color-chooser-circle"),this.#z=this.$("#muigui-color-chooser-hue"),this.#P=this.$(".muigui-color-chooser-cursor");const i=t=>{const i=n(t.nx,0,1),o=n(t.ny,0,1);this.#G[1]=i,this.#G[2]=1-o,this.#B=!0,e.setValue(Y(tt(this.#G)))},o=t=>{const i=n(t.nx,0,1);this.#G[0]=i,this.#H=!0,e.setValue(Y(tt(this.#G)))};Dt(this.#O,{onDown:i,onMove:i}),Dt(this.#j,{onDown:o,onMove:o})}updateDisplay(t){this.#G||(this.#G=nt(R(t)));{const[e,n,i]=nt(R(t));this.#B||(this.#G[0]=n>.001&&i>.001?e:this.#G[0]),this.#H||(this.#G[1]=n,this.#G[2]=i)}{const[t,e,n]=this.#G;this.#B||(this.#P.setAttribute("transform",`translate(${64*t}, 0)`),this.#z.children[0].setAttribute("stop-color",`hsl(${360*t}, 0%, 100%)`),this.#z.children[1].setAttribute("stop-color",`hsl(${360*t}, 100%, 50%)`)),this.#H||(this.#T.setAttribute("cx",""+64*e),this.#T.setAttribute("cy",""+48*(1-n)))}this.#B=!1,this.#H=!1}}class Lt extends E{#R;#Y;#W;#u={open:!1};constructor(e,n,i={}){super(e,n,"muigui-pop-down-controller"),this.#R=this.add(new j("div","muigui-pop-down-top"));const o=this.#R.addElem(t("input",{type:"checkbox",onChange:()=>{this.#u.open=o.checked}}));this.#Y=this.#R.add(new j("div","muigui-pop-down-values")),this.#W=this.add(new j("div","muigui-pop-down-bottom")),this.setOptions(i)}updateDisplay(){super.updateDisplay();const{open:t}=this.#u;this.domElement.children[1].classList.toggle("muigui-open",t),this.domElement.children[1].classList.toggle("muigui-closed",!t)}setOptions(t){r(this.#u,t),super.setOptions(t),this.updateDisplay()}addTop(t){return this.#Y.add(t)}addBottom(t){return this.#W.add(t)}}function Nt(){}const St={ArrowLeft:[-1,0],ArrowRight:[1,0],ArrowUp:[0,-1],ArrowDown:[0,1]};function At(t,{onDown:e=Nt,onUp:n=Nt}){const i=function(t){const i=t.shiftKey?10:1,[o,s]=(St[t.key]||[0,0]).map((t=>t*i));("keydown"===t.type?e:n)({type:t.type.substring(3),dx:o,dy:s,event:t})};return t.addEventListener("keydown",i),t.addEventListener("keyup",i),function(){t.removeEventListener("keydown",i),t.removeEventListener("keyup",i)}}function Ut(t,e=""){if(!t)throw new Error(e)}function Ot(t,e,n,i,o,s){const r=Math.abs(n)*Math.cos(s),a=Math.abs(i)*Math.sin(s);return[t+Math.cos(o)*r-Math.sin(o)*a,e+Math.sin(o)*r+Math.cos(o)*a]}function jt(t,e,n,i,o){Ut(Math.abs(i-o)<=2*Math.PI),Ut(i>=-Math.PI&&i<=2*Math.PI),Ut(i<=o),Ut(o>=-Math.PI&&o<=4*Math.PI);const{x1:s,y1:r,x2:a,y2:l,fa:u,fs:c}=function(t,e,n,i,o,s,r){const[a,l]=Ot(t,e,n,i,o,s),[u,c]=Ot(t,e,n,i,o,s+r);return{x1:a,y1:l,x2:u,y2:c,fa:Math.abs(r)>Math.PI?1:0,fs:r>0?1:0}}(t,e,n,n,0,i,o-i);return Math.abs(Math.abs(i-o)-2*Math.PI)>Number.EPSILON?`M${t} ${e} L${s} ${r} A ${n} ${n} 0 ${u} ${c} ${a} ${l} L${t} ${e}`:`M${s} ${r} L${s} ${r} A ${n} ${n} 0 ${u} ${c} ${a} ${l}`}const Tt=t=>s(t+Math.PI,2*Math.PI)-Math.PI;class zt extends h{#q;#_;#J;#K;#u={step:1,min:-180,max:180,dirMin:-Math.PI,dirMax:Math.PI,wrap:void 0,converters:C};constructor(e,i={}){const r=M();super(t("div",{className:"muigui-direction muigui-no-scroll",innerHTML:'\n<svg tabindex="0" viewBox="-32 -32 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">\n    \x3c!--<circle id="muigui-outline" cx="0" cy="0" r="28.871" class="muigui-direction-circle"/>--\x3e\n    <path id="muigui-range" class="muigui-direction-range" />\n    <g id="muigui-arrow">\n        <g transform="translate(-32, -32)">\n          <path d="M31.029,33.883c-1.058,-0.007 -1.916,-0.868 -1.916,-1.928c0,-1.065 0.864,-1.929 1.929,-1.929c0.204,0 0.401,0.032 0.586,0.091l14.729,-0l0,-2.585l12.166,4.468l-12.166,4.468l0,-2.585l-15.315,0l-0.013,0Z" class="muigui-direction-arrow"/>\n        </g>\n    </g>\n</svg>\n',onWheel:t=>{t.preventDefault();const{min:i,max:a,step:l}=this.#u,u=r(t,l);let c=this.#J+u;this.#K&&(c=s(c-i,a-i)+i);const h=n(o(c,(t=>t),l),i,a);e.setValue(h)}}));const a=t=>{const{min:i,max:s,step:r,dirMin:a,dirMax:l}=this.#u,u=2*t.nx-1,c=2*t.ny-1,h=Math.atan2(c,u),d=(a+l)/2,p=n((Tt(h-d)-Tt(a-d))/(l-a),0,1),m=o(i+(s-i)*p,(t=>t),r);e.setValue(m)};Dt(this.domElement,{onDown:a,onMove:a}),At(this.domElement,{onDown:t=>{const{min:i,max:s,step:r}=this.#u,a=n(o(this.#J+t.dx*r,(t=>t),r),i,s);e.setValue(a)}}),this.#q=this.$("#muigui-arrow"),this.#_=this.$("#muigui-range"),this.setOptions(i)}updateDisplay(t){this.#J=t;const{min:e,max:n}=this.#u,i=(t-e)/(n-e),o=(s=this.#u.dirMin,r=this.#u.dirMax,s+(r-s)*i);var s,r;this.#q.style.transform=`rotate(${o}rad)`}setOptions(t){r(this.#u,t);const{dirMin:e,dirMax:n,wrap:i}=this.#u;this.#K=void 0!==i?i:Math.abs(e-n)>=2*Math.PI-Number.EPSILON;const[o,s]=e<n?[e,n]:[n,e];this.#_.setAttribute("d",jt(0,0,28.87,o,s))}}class Pt extends h{#D;constructor(e,n,i=3){const o=[],s=w();super(t("div",{},n.map((([n,i],a)=>(o.push(i),t("label",{},[t("input",{type:"radio",name:s,value:a,onChange:function(){this.checked&&e.setFinalValue(r.#D[this.value])}}),t("button",{type:"button",textContent:n,onClick:function(){this.previousElementSibling.click()}})]))))));const r=this;this.#D=o,this.cols(i)}updateDisplay(t){const e=this.#D.indexOf(t);for(let t=0;t<this.domElement.children.length;++t)this.domElement.children[t].children[0].checked=t===e}cols(t){this.domElement.style.gridTemplateColumns=`repeat(${t}, 1fr)`}}function Gt(t,e){new ResizeObserver((()=>{e({rect:t.getBoundingClientRect(),elem:t})})).observe(t)}function Bt(t,e,n,i){Gt(t,(({rect:o})=>{const{width:s,height:r}=o;t.setAttribute("viewBox",`-${s*e} -${r*n} ${s} ${r}`),i({elem:t,rect:o})}))}function Ht(t,e,n,i,s,r){const a=[];t<i&&(t+=o(i-t,(t=>t),n)),e=Math.min(e,s);for(let i=t;i<=e;i+=n)a.push(`M${i} 0 l0 ${r}`);return a.join(" ")}class Rt extends h{#X;#Z;#Q;#tt;#et;#nt;#it;#ot;#st;#J;#rt;#u={min:-100,max:100,step:1,unit:10,unitSize:10,ticksPerUnit:5,labelFn:t=>t,tickHeight:1,limits:!0,thicksColor:void 0,orientation:void 0};constructor(e,i){const s=M();let r;super(t("div",{innerHTML:'\n<svg tabindex="0" viewBox="-32 -32 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">\n  <g id="muigui-orientation">\n    <g id="muigui-origin">\n      <g transform="translate(0, 4)">\n        <path id="muigui-ticks" class="muigui-ticks"/>\n        <path id="muigui-thicks" class="muigui-thicks"/>\n      </g>\n      <g transform="translate(0, 14)">\n        <g id="muigui-number-orientation">\n          <g id="muigui-numbers" transform="translate(0, -3)" class="muigui-svg-text"/>\n        </g>\n      </g>\n    </g>\n    <linearGradient id="muigui-bg-to-transparent">\n      <stop stop-color="var(--value-bg-color)" offset="0%"/>\n      <stop stop-color="var(--value-bg-color)" stop-opacity="0" offset="100%"/>\n    </linearGradient>\n    <linearGradient id="muigui-transparent-to-bg">\n      <stop stop-color="var(--value-bg-color)" stop-opacity="0"  offset="0%"/>\n      <stop stop-color="var(--value-bg-color)" offset="100%"/>  \n    </linearGradient>\n    \x3c!--<circle cx="0" cy="2" r="2" class="muigui-mark"/>--\x3e\n    \x3c!--<rect x="-1" y="0" width="2" height="10" class="muigui-mark"/>--\x3e\n    <path d="M0 4L-2 0L2 0" class="muigui-mark"/>\n  </g>\n  <rect id="muigui-left-grad" x="0" y="0" width="20" height="20" fill="url(#muigui-bg-to-transparent)"/>\n  <rect id="muigui-right-grad" x="48" y="0" width="20" height="20" fill="url(#muigui-transparent-to-bg)"/>\n</svg>\n',className:"muigui-no-v-scroll",onWheel:t=>{t.preventDefault();const{min:i,max:r,step:a}=this.#u,l=s(t,a),u=n(o(this.#J+l,(t=>t),a),i,r);e.setValue(u)}})),this.#X=this.$("svg"),this.#Z=this.$("#muigui-origin"),this.#Q=this.$("#muigui-ticks"),this.#tt=this.$("#muigui-thicks"),this.#et=this.$("#muigui-numbers"),this.#nt=this.$("#muigui-left-grad"),this.#it=this.$("#muigui-right-grad"),this.setOptions(i),Dt(this.domElement,{onDown:()=>{r=this.#J},onMove:t=>{const{min:i,max:s,unitSize:a,unit:l,step:u}=this.#u,c=n(o(r-t.dx/a*l,(t=>t),u),i,s);e.setValue(c)}}),At(this.domElement,{onDown:t=>{const{min:i,max:s,step:r}=this.#u,a=n(o(this.#J+t.dx*r,(t=>t),r),i,s);e.setValue(a)}}),Bt(this.#X,.5,0,(({rect:{width:t}})=>{this.#nt.setAttribute("x",-t/2),this.#it.setAttribute("x",t/2-20),this.#rt=function(t){const e=t.innerHTML;t.innerHTML="<text>- </text>";const n=t.querySelector("text").getComputedTextLength();return t.innerHTML=e,n}(this.#et),this.#ot=t,this.#at()}))}#at(){if(!this.#ot||void 0===this.#J)return;const{labelFn:t,limits:e,min:n,max:i,orientation:s,tickHeight:r,ticksPerUnit:a,unit:l,unitSize:u,thicksColor:c}=this.#u,h=Math.ceil(this.#ot/u),d=this.#J/l,p=Math.round(d-h),m=p*u,g=(p+2*h)*u,f=e?n*u/l:m,b=e?i*u/l:g,v=""===t(1)?10:5;a>1&&this.#Q.setAttribute("d",Ht(m,g,u/a,f,b,v*r)),this.#tt.style.stroke=c,this.#tt.setAttribute("d",Ht(m,g,u,f,b,v)),this.#et.innerHTML=function(t,e,n,i,s,r,a,l){const u=[];t<r&&(t+=o(r-t,(t=>t),n)),e=Math.min(e,a);const c=Math.max(0,-Math.log10(i));for(let o=t;o<=e;o+=n)u.push(`<text text-anchor="middle" dominant-baseline="hanging" x="${o>=0?o:o-s/2}" y="0">${h=o/n*i,l(h.toFixed(c))}</text>`);var h;return u.join("\n")}(m,g,u,l,this.#rt,f,b,t),this.#Z.setAttribute("transform",`translate(${-this.#J*u/l} 0)`),this.#X.classList.toggle("muigui-slider-up","up"===s)}updateDisplay(t){this.#J=t,this.#at()}setOptions(t){return r(this.#u,t),this}}class Yt extends h{#X;#q;#T;#J=[];constructor(e){super(t("div",{innerHTML:'\n<svg tabindex="0" viewBox="-32 -32 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">\n  <path d="m-3200,0L3200,0M0,-3200L0,3200" class="muigui-vec2-axis"/>\n  <path id="muigui-arrow" d="" class="muigui-vec2-line"/>\n  <g id="muigui-circle" transform="translate(0, 0)">\n    <circle r="3" class="muigui-vec2-axis"/>\n  </g>\n</svg>\n',className:"muigui-no-scroll"}));const n=t=>{const{width:n,height:i}=this.#X.getBoundingClientRect(),o=2*t.nx-1,s=2*t.ny-1;e.setValue([o*n*.5,s*i*.5])};Dt(this.domElement,{onDown:n,onMove:n}),this.#X=this.$("svg"),this.#q=this.$("#muigui-arrow"),this.#T=this.$("#muigui-circle"),Bt(this.#X,.5,.5,(()=>this.#lt))}#lt(){const[t,e]=this.#J;this.#q.setAttribute("d",`M0,0L${t},${e}`),this.#T.setAttribute("transform",`translate(${t}, ${e})`)}updateDisplay(t){this.#J[0]=t[0],this.#J[1]=t[1],this.#lt()}}return Vt.ColorChooser=class extends Lt{constructor(t,e){super(t,e,"muigui-color-chooser"),this.addTop(new U(this)),this.addBottom(new Ft(this)),this.updateDisplay()}},Vt.Direction=class extends Lt{#u;constructor(t,e,n){super(t,e,"muigui-direction"),this.#u=n,this.addTop(new I(this,C)),this.addBottom(new zt(this,n)),this.updateDisplay()}},Vt.RadioGrid=class extends E{constructor(t,e,n){super(t,e,"muigui-radio-grid");const i="number"==typeof this.getValue(),{keyValues:o,cols:s=3}=n,r=L(o,i);this.add(new Pt(this,r,s)),this.updateDisplay()}},Vt.Range=A,Vt.Select=N,Vt.Slider=class extends E{constructor(t,e,n={}){super(t,e,"muigui-slider"),this.add(new Rt(this,n)),this.add(new I(this,n)),this.updateDisplay()}},Vt.TextNumber=D,Vt.Vec2=class extends Lt{constructor(t,e){super(t,e,"muigui-vec2");const n=t=>({setValue:e=>{const n=this.getValue();n[t]=e,this.setValue(n)},setFinalValue:e=>{const n=this.getValue();n[t]=e,this.setFinalValue(n)}});this.addTop(new I(n(0),{converters:{to:t=>t[0],from:V.from}})),this.addTop(new I(n(1),{converters:{to:t=>t[1],from:V.from}})),this.addBottom(new Yt(this)),this.updateDisplay()}},Vt}));
