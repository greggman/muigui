/* unzipit@0.0.1, license MIT */
(function(k,f){"object"===typeof exports&&"undefined"!==typeof module?f(exports):"function"===typeof define&&define.amd?define(["exports"],f):(k="undefined"!==typeof globalThis?globalThis:k||self,f(k.GUI={}))})(this,function(k){function f(a,b={},c=[]){a=document.createElement(a);for(const [d,e]of Object.entries(b))if("function"===typeof e&&d.startsWith("on"))b=d.substring(2).toLowerCase(),a.addEventListener(b,e,{passive:!1});else if("object"===typeof e)for(const [h,g]of Object.entries(e))a[d][h]=
g;else void 0===a[d]?a.setAttribute(d,e):a[d]=e;for(const d of c)a.appendChild(d);return a}function r(a,b){(b=a.indexOf(b))&&a.splice(b,1);return a}function F(){n.size&&(t?u():(n.forEach(a=>{r(l,a)}),n.clear()))}function G(){v=void 0;t=!0;for(const a of l)n.has(a)||a();t=!1;F();u()}function u(){!v&&l.length&&(v=requestAnimationFrame(G))}function y(a){for(const b of H)if(b.re.test(a))return b}function I(a){switch(typeof a){case "number":return"uint32-rgb";case "string":const b=y(a.trim());if(b)return b.format;
break;case "object":if(3===a.length)return"float-rgb";if("r"in a&&"g"in a&&"b"in a)return"object-rgb"}throw Error(`unknown color format: ${a}`);}function z(a){const b=y(a.trim());return(b?b.fix:c=>c)(a.trim())}function J(a,b){return Array.isArray(a)?Array.isArray(a[0])?a:b?a.map((c,d)=>[c,d]):a.map(c=>[c,c]):[...Object.entries(a)]}function K(a,b,...c){const [d]=c;if("object"===typeof d&&("function"!==typeof d.to||"function"!==typeof d.from))return new L(a,b,...c);switch(typeof a[b]){case "number":return 0===
c.length||2>=c.length&&"object"===typeof c[0]?new M(a,b,...c):new N(a,b,...c);case "boolean":return new O(a,b,...c);case "function":return new P(a,b,...c);case "string":return new Q(a,b,...c)}}let R=0;class p{constructor(a){this._root=f("div",{className:"muigui-controller"});a&&this._root.classList.add(a)}get domElement(){return this._root}show(a=!0){this._root.classList.toggle("muigui-hide",!a);this._root.classList.toggle("muigui-show",a);return this}hide(){return this.show(!1)}enable(a=!0){this._root.classList.toggle("muigui-disabled",
!a);return this}disable(a=!0){return this.enable(!a)}getColors(){const a=d=>d.replace(/-([a-z])/g,(e,h)=>h.toUpperCase()),b=f("div");this._root.appendChild(b);const c=Object.fromEntries("color bg-color value-color value-bg-color hover-bg-color menu-bg-color menu-sep-color disabled-color".split(" ").map(d=>{b.style.color=`var(--${d})`;const e=getComputedStyle(b);return[a(d),e.color]}));b.remove();return c}}class A extends p{constructor(a="",b=""){super();this._id=`muigui-${++R}`;this._nameElem=f("label",
{for:this._id});this._contentElem=f("div",{className:"muigui-value"});this._contentElem.classList.add(a);this.domElement.appendChild(this._nameElem);this.domElement.appendChild(this._contentElem);this.name(b)}get id(){return this._id}get contentElement(){return this._contentElem}name(a){this._nameElem.textContent=a;this._nameElem.title=a;return this}}class S extends A{constructor(a){super("muigui-canvas",a);a=this.contentElement;this._canvasElem=f("canvas");a.appendChild(this._canvasElem)}get canvas(){return this._canvasElem}}
const l=[],n=new Set;let v,t;class m extends A{constructor(a,b,c=""){super(c,b);this._object=a;this._property=b;this._initialValue=this.getValue();this._changeFns=[];this._finishChangeFns=[];this._listening=!1}get initialValue(){return this._initialValue}get object(){return this._object}get property(){return this._property}setJustValue(a){this._object[this._property]=a}_callListeners(a){const b=this.getValue();for(const c of a)c.call(this,b)}setValue(a){this._object[this._property]=a;this._callListeners(this._changeFns)}setFinalValue(a){this.setValue(a);
this._callListeners(this._finishChangeFns)}getValue(a){return this._object[this._property]}value(a){this.setValue(a);return this}reset(){this.setValue(this._initialValue);return this}onChange(a){this.removeChange(a);this._changeFns.push(a);return this}removeChange(a){r(this._changeFns,a);return this}onFinishChange(a){this.removeFinishChange(a);this._finishChangeFns.push(a);return this}removeFinishChange(a){r(this._finishChangeFns,a);return this}listen(a=!0){this._updateFn||(this._updateFn=this.updateDisplay.bind(this));
a?this._listening||(this._listening=!0,l.push(this._updateFn),u()):this._listening&&(this._listening=!1,a=this._updateFn,n.set(a),a=l.indexOf(a),0<=a&&l.splice(a,1));return this}}const w=a=>[parseInt(a.substring(1,3),16),parseInt(a.substring(3,5),16),parseInt(a.substring(5,7),16)],x=a=>`#${a.map(b=>b.toString(16).padStart(2,"0")).join("")}`,B=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,C=a=>`${a[0]}${a[0]}${a[1]}${a[1]}${a[2]}${a[2]}`,H=[{re:/^#(?:[0-9a-f]){6}$/i,format:"hex",fix:a=>a},{re:/^(?:[0-9a-f]){6}$/i,
format:"hex-no-hash",fix:a=>a},{re:/^#(?:[0-9a-f]){3}$/i,format:"hex",fix:a=>`#${C(a.substring(1))}`},{re:/^(?:[0-9a-f]){3}$/i,format:"hex-no-hash",fix:a=>C(a)},{re:B,format:"css-rgb",fix:a=>a}],T={hex:{fromHex:a=>a,toHex:a=>z(a)},"uint32-rgb":{fromHex:a=>parseInt(a.substring(1,3),16)<<16|parseInt(a.substring(3,5),16)<<8|parseInt(a.substring(5,7),16),toHex:a=>`#${(a|0).toString(16).padStart(6,"0")}`},"uint8-rgb":{fromHex:w,toHex:x},"float-rgb":{fromHex:a=>w(a).map(b=>b/255),toHex:a=>x(a.map(b=>Math.max(0,
Math.min(255,255*b))))},"object-rgb":{fromHex:a=>({r:parseInt(a.substring(1,3),16)/255,g:parseInt(a.substring(3,5),16)/255,b:parseInt(a.substring(5,7),16)/255}),toHex:a=>`#${Math.max(0,Math.min(255,255*a.r|0)).toString(16).padStart(2,"0")}${Math.max(0,Math.min(255,255*a.g|0)).toString(16).padStart(2,"0")}${Math.max(0,Math.min(255,255*a.b|0)).toString(16).padStart(2,"0")}`},"css-rgb":{fromHex:a=>`rgb(${w(a)})`,toHex:a=>{a=B.exec(a);return x([a[1],a[2],a[3]].map(b=>parseInt(b)))}},"hex-no-hash":{fromHex:a=>
a.substring(1),toHex:a=>`#${z(a)}`}};class U extends m{constructor(a,b,c){super(a,b,"muigui-color");a=this.contentElement;b=this.id;c=c||I(this.getValue());this._converters=T[c];const {fromHex:d}=this._converters;this._colorElem=f("input",{type:"color",id:b,onInput:e=>{this.setValue(d(this._colorElem.value))},onChange:e=>{this.setFinalValue(d(this._colorElem.value))}});a.appendChild(f("div",{},[this._colorElem]));this._textElem=f("input",{type:"text",pattern:/[a-f0-9]{6}/i,onInput:e=>{this.setValue(d(`#${this._textElem.value}`))},
onChange:e=>{this.setFinalValue(d(`#${this._textElem.value}`))}});a.appendChild(this._textElem);this.updateDisplay()}updateDisplay(){const a=this._converters.toHex(super.getValue());this._textElem.value=a.substring(1);this._colorElem.value=a;return this}setValue(a){super.setValue(a);this.updateDisplay();return this}}class P extends p{constructor(a,b){super("muigui-button","");const c=this.domElement;this._object=a;this._property=b;this._buttonElem=f("button",{type:"button",textContent:b,onClick:d=>
{this._object[this._property](this)}});c.appendChild(this._buttonElem)}name(a){this._buttonElem.textContent=a;return this}updateDisplay(){}onChange(){return this}onFinishChange(){return this}}class O extends m{constructor(a,b){super(a,b,"muigui-checkbox");a=this.contentElement;this._checkboxElem=f("input",{type:"checkbox",id:this.id,onInput:c=>{this.setValue(this._checkboxElem.checked)},onChange:c=>{this.setFinalValue(this._checkboxElem.checked)}});this.updateDisplay();a.appendChild(f("label",{},
[this._checkboxElem]))}updateDisplay(){const a=super.getValue();this._checkboxElem.checked=a}setValue(a){super.setValue(a)}}const V={from:a=>a,to:a=>a};class M extends m{constructor(a,b,c=V,d=.01){super(a,b,"muigui-checkbox");a=this.contentElement;this._textElem=f("input",{type:"number",id:this.id,onInput:e=>{e=parseFloat(this._textElem.value);Number.isNaN(e)||this.setValue(this._to(e))},onChange:e=>{e=parseFloat(this._textElem.value);Number.isNaN(e)||this.setFinalValue(this._to(e))}});this.conversion(c);
this.step(d);this.updateDisplay();a.appendChild(this._textElem)}step(a){this._step=a;this.updateDisplay();return this}updateDisplay(){var a=super.getValue();a=Math.round(this._from(a)/this._step)/(1/this._step);this._textElem.value=a;return this}conversion(a){this._from=a.from;this._to=a.to;this.updateDisplay();return this}}class L extends m{constructor(a,b,c){super(a,b,"muigui-select");a=this.contentElement;b="number"===typeof this.getValue();c=J(c,b);this._values=[];this._selectElem=f("select",
{onChange:d=>{this.setFinalValue(this._values[this._selectElem.selectedIndex])}},c.map(([d,e])=>{this._values.push(e);return f("option",{textContent:d})}));this.updateDisplay();a.appendChild(this._selectElem)}updateDisplay(){var a=super.getValue();a=this._values.indexOf(a);this._selectElem.selectedIndex=a}setValue(a){super.setValue(a);this.updateDisplay()}}const W={from:a=>a,to:a=>a};class N extends m{constructor(a,b,c=0,d=1,e=.01,h=W){super(a,b,"muigui-slider");a=this.contentElement;this._rangeElem=
f("input",{type:"range",id:this.id,onInput:g=>{this._skipUpdateRangeElem=!0;this.setValue(this._to(this._rangeElem.value))},onChange:g=>{this._skipUpdateRangeElem=!0;this.setFinalValue(this._to(this._rangeElem.value))}});this._textElem=f("input",{type:"number",onInput:g=>{g=parseFloat(this._textElem.value);Number.isNaN(g)||(this._skipUpdateTextElem=!0,this.setValue(this._to(g)))},onChange:g=>{g=parseFloat(this._textElem.value);Number.isNaN(g)||(this._skipUpdateTextElem=!0,this.setFinalValue(this._to(g)))}});
this.conversion(h);this.min(c);this.max(d);this.step(e);a.appendChild(this._rangeElem);a.appendChild(this._textElem);this.updateDisplay()}min(a){this._rangeElem.min=a;return this}max(a){this._rangeElem.max=a;return this}step(a){this._step=this._rangeElem.step=a;this.updateDisplay();return this}conversion(a){this._from=a.from;this._to=a.to;this.updateDisplay();return this}updateDisplay(){var a=super.getValue();a=Math.round(this._from(a)/this._step)/(1/this._step);this._skipUpdateTextElem||(this._textElem.value=
a);this._skipUpdateRangeElem||(this._rangeElem.value=a);this._skipUpdateTextElem=this._skipUpdateRangeElem=!1;return this}setValue(a){super.setValue(a);this.updateDisplay();return this}}class Q extends m{constructor(a,b){super(a,b,"muigui-checkbox");a=this.contentElement;this._textElem=f("input",{type:"text",id:this.id,onInput:c=>{this.setValue(this._textElem.value)},onChange:c=>{this.setFinalValue(this._textElem.value)}});this.updateDisplay();a.appendChild(this._textElem)}updateDisplay(){const a=
super.getValue();this._textElem.value=a;return this}}class X extends p{constructor(){super("muigui-divider")}}class Y extends p{constructor(a){super("muigui-label");this.text(a)}text(a){this.domElement.textContent=a;return this}}class q extends p{constructor(a="Controls",b="muigui-menu"){super(b);this._labelElem=f("label");this.domElement.appendChild(f("div",{onClick:()=>{this.toggleOpen()}},[this._labelElem]));this._controllerElem=f("div");this._controllers=[];this.domElement.appendChild(this._controllerElem);
this.name(a);this.open()}get children(){return this._controllers}get controllers(){return this._controllers.filter(a=>!(a instanceof q))}get folders(){return this._controllers.filter(a=>a instanceof q)}reset(a=!0){for(const b of this._controllers)b instanceof q&&!a||b.reset(a);return this}open(a=!0){this.domElement.classList.toggle("muigui-closed",!a);this.domElement.classList.toggle("muigui-open",a);return this}close(){return this.open(!1)}name(a){this._labelElem.textContent=a;return this}title(a){return this.name(a)}toggleOpen(){this.open(!this.domElement.classList.contains("muigui-open"));
return this}remove(a){a=this._controllers.indexOf(a);0<=a&&this._controllers.splice(a,1)[0].domElement.remove()}addController(a){this._controllerElem.appendChild(a.domElement);this._controllers.push(a);return a}add(a,b,...c){return this.addController(K(a,b,...c))}addCanvas(a){return this.addController(new S(a))}addColor(a,b,...c){return this.addController(new U(a,b,...c))}addDivider(){return this.addController(new X)}addFolder(a){return this.addController(new q(a))}addLabel(a){return this.addController(new Y(a))}}
let D=!1;const E=f("style");class Z extends q{constructor(a){super("Controls","muigui-root");a instanceof HTMLElement&&(a={parent:a});let {parent:b,autoPlace:c=!0,width:d,title:e="Controls",injectStyles:h=!0}=a;h&&!D&&(D=!0,(document.head||document.documentElement).appendChild(E),E.textContent='\n.muigui {\n  --width: 250px;\n  --label-width: 45%;\n\n  --bg-color: #222222;\n  --color: #dddddd;\n  --value-color: #43e5f7;\n  --value-bg-color: #444444;\n  --disabled-color: #666666;\n  --menu-bg-color: #000000;\n  --menu-sep-color: #444444;\n  --hover-bg-color: #666666;\n\n  --button-bg-color: var(--value-bg-color);\n\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-size: 11px;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --font-size-mono: 11px;\n\n  --slider-width: 30px;\n\n  --slider-left-color: var(--value-color);\n  --slider-right-color: var(--value-bg-color);\n  --slider-right-hover-color: var(--hover-bg-color);\n  --line-height: 1.7em;\n\n  width: var(--width);\n  color: var(--color);\n  background-color: var(--bg-color);\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  box-sizing: border-box;\n}\n.muigui * {\n  box-sizing: inherit;\n}\n\n.muigui-show { /* */ }\n.muigui-hide { \n  display: none !important;\n}\n.muigui-disabled {\n  pointer-events: none;\n  --color: var(--disabled-color) !important;\n  --value-color: var(--disabled-color) !important;\n  --slider-left-color: var(--disabled-color) !important;\n}\n\n.muigui canvas {\n  display: block;\n  background-color: var(--value-bg-color);\n}\n\n.muigui-controller {\n  word-wrap: initial;\n  display: flex;\n  align-items: stretch;\n  min-width: 0;\n  min-height: var(--line-height);\n  margin: 0.4em 0 0.4em 0;\n}\n.muigui-root,\n.muigui-menu {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  user-select: none;\n  height: fit-content;\n  margin: 0;\n  padding-bottom: 0.1em;\n}\n.muigui-menu {\n  border-bottom: 1px solid var(--menu-sep-color);\n}\n\n.muigui-root>div:nth-child(1),\n.muigui-menu>div:nth-child(1) {\n  border-top: 1px solid var(--menu-sep-color);\n  border-bottom: 1px solid var(--menu-sep-color);\n  position: relative;\n  background-color: var(--menu-bg-color);\n  min-height: var(--line-height);\n  padding-top: 0.2em;\n  padding-bottom: 0.2em;\n  cursor: pointer;\n}\n.muigui-root>div:nth-child(2),\n.muigui-menu>div:nth-child(2) {\n  flex: 1 1 auto;\n}\n\n.muigui-controller {\n  margin-left: 0.2em;\n  margin-right: 0.2em;\n}\n.muigui-root.muigui-controller,\n.muigui-menu.muigui-controller {\n  margin-left: 0;\n  margin-right: 0;\n}\n.muigui-controller>*:nth-child(1) {\n  flex: 1 0 var(--label-width);\n  min-width: 0;\n  white-space: pre;\n}\n.muigui-controller>label:nth-child(1) {\n  place-content: center start;\n  display: inline-grid;\n}\n.muigui-controller>*:nth-child(2) {\n  flex: 1 1 75%;\n  min-width: 0;\n}\n.muigui-value {\n  display: flex;\n  align-items: stretch;\n}\n.muigui-value>* {\n  flex: 1 1 auto;\n  min-width: 0;\n}\n.muigui-value>*:nth-child(1) {\n  flex: 1 1 60%;\n}\n.muigui-value>*:nth-child(2) {\n  flex: 1 1 40%;\n  margin-left: 0.2em;\n}\n\n/* fix! */\n.muigui-open>div>label::before,\n.muigui-closed>div>label::before {\n  width: 1.5em;\n  height: var(--line-height);\n  display: inline-grid;\n  place-content: center;\n  pointer-events: none;\n}\n.muigui-open>div>label::before {\n  content: "\u25bc";\n}\n.muigui-closed>div>label::before {\n  content: "\u25b6";\n}\n.muigui-open>*:nth-child(2) {\n  transition: max-height 0.2s ease-out,\n              opacity 0.5s ease-out;\n  max-height: 100vh;\n  overflow: auto;\n  opacity: 1;\n}\n\n.muigui-closed>*:nth-child(2) {\n  transition: max-height 0.2s ease-out,\n              opacity 1s;\n  max-height: 0;\n  opacity: 0;\n  overflow: hidden;\n}\n\n.muigui select,\n.muigui option,\n.muigui input,\n.muigui button {\n  color: var(--value-color);\n  background-color: var(--value-bg-color);\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  border: none;\n}\n.muigui select {\n  margin-left: 0; /*?*/\n}\n\n.muigui select:hover,\n.muigui option:hover,\n.muigui input:hover,\n.muigui button:hover {\n  background-color: var(--hover-bg-color);  \n}\n\n/* ------ [ label ] ------ */\n\n.muigui-label {\n  border-top: 1px solid var(--menu-sep-color);\n  border-bottom: 1px solid var(--menu-sep-color);\n  padding-top: 0.4em;\n  padding-bottom: 0.3em;\n  place-content: center start;\n  background-color: var(--menu-bg-color);\n  white-space: pre;\n}\n\n/* ------ [ divider] ------ */\n\n.muigui-divider {\n    min-height: 6px;\n    border-top: 2px solid var(--menu-sep-color);\n    margin-top: 6px;\n}\n\n/* ------ [ button ] ------ */\n\n.muigui-button button {\n  border: none;\n  color: var(--value-color);\n  background-color: var(--button-bg-color);\n  cursor: pointer;\n  place-content: center center;\n}\n\n/* ------ [ color ] ------ */\n\n.muigui-color>div {\n  overflow: hidden;\n  position: relative;\n  margin-left: 0;\n  margin-right: 0; /* why? */\n}\n\n.muigui-color input[type=color] {\n  border: none;\n  padding: 0;\n  background: inherit;\n  cursor: pointer;\n  position: absolute;\n  width: 200%;\n  left: -10px;\n  top: -10px;\n  height: 200%;\n}\n.muigui-disabled canvas,\n.muigui-disabled .muigui-color input[type=color] {\n  opacity: 0.3;\n}\n\n/* ------ [ checkbox ] ------ */\n\n.muigui-checkbox>label:nth-child(2) {\n  display: grid;\n  place-content: center start;\n  margin: 0;\n}\n\n.muigui-checkbox input[type=checkbox] {\n  appearance: none;\n  width: auto;\n  color: var(--value-color);\n  background-color: var(--value-bg-color);\n  cursor: pointer;\n\n  display: grid;\n  place-content: center;\n  margin: 0;\n  font: inherit;\n  color: currentColor;\n  width: 1.7em;\n  height: 1.7em;\n  transform: translateY(-0.075em);\n}\n\n.muigui-checkbox input[type=checkbox]::before {\n  content: "";\n  color: var(--value-color);\n  display: grid;\n  place-content: center;\n}\n\n.muigui-checkbox input[type=checkbox]:checked::before {\n  content: "\u2714";\n}\n\n.muigui input[type=number]::-webkit-inner-spin-button, \n.muigui input[type=number]::-webkit-outer-spin-button { \n  appearance: none; \n  margin: 0; \n}\n.muigui input[type=number] {\n  -moz-appearance: textfield;\n}\n\n/* ------ [ slider ] ------ */\n\n/* fix below */\n.muigui-slider input[type=range] {\n  cursor: ew-resize;\n  overflow: hidden;\n}\n\n.muigui-slider input[type=range] {\n  appearance: none;\n  background-color: var(--slider-right-color);\n  margin: 0;\n}\n.muigui-slider input[type=range]:hover {\n  background-color: var(--slider-right-hover-color);\n}\n\n.muigui-slider input[type=range]::-webkit-slider-runnable-track {\n  appearance: none;\n  height: max-content;\n  color: var(--slider-left-color);\n  margin-top: -1px;\n}\n.muigui-slider input[type=range]::-webkit-slider-runnable-track {\n  color: red;\n}\n\n.muigui-slider input[type=range]::-webkit-slider-thumb {\n  appearance: none;\n  width: 0px;\n  height: max-content;\n  box-shadow: -1000px 0 0 1000px var(--slider-left-color);\n}\n\n/* FF */\n.muigui-slider input[type=range]::-moz-range-progress {\n  background-color: var(--slider-left-color); \n}\n.muigui-slider input[type=range]::-moz-range-thumb {\n  height: max-content;\n  width: 0;\n  border: none;\n  box-shadow: -1000px 0 0 1000px var(--slider-left-color);\n  box-sizing: border-box;\n}\n\n/* needs to be at bottom to take precedence */\n.muigui-auto-place {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 100001;\n}\n');
d&&(this.domElement.style.width=/^\d+$/.test(d)?`${d}px`:d);void 0===b&&c&&(b=document.body,this.domElement.classList.add("muigui-auto-place"));b&&b.appendChild(this.domElement);e&&this.title(e);this.domElement.classList.add("muigui")}}k.GUI=Z;Object.defineProperty(k,"__esModule",{value:!0})});
